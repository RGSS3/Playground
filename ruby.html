<!doctype html>
<title>Ruby</title>
<script src='https://unpkg.com/requirejs/require.js'></script>

<div id='code'>
</div>

<div id='output'>
</div>


<link href='https://unpkg.com/codemirror/lib/codemirror.css' rel='stylesheet' type='text/css' />
<link href='https://unpkg.com/codemirror/theme/solarized.css' rel='stylesheet' type='text/css' />
<script>
   requirejs.config(
    {paths:
      {
         codemirror:'https://unpkg.com/codemirror',
         'codemirror/lib': 'https://unpkg.com/codemirror',
      }
    }
   );
  
   
   let unpkg = key => `https://unpkg.com/${key}`;
   
   let $load = key => 
      new Promise((ac, re) => 
         require([key], ac));
   
   
   
   window.addEventListener('load', function(){
     Promise.all([$load('codemirror/lib/codemirror'), $load(unpkg('codemirror/mode/ruby/ruby.js')), $load('https://cdnjs.cloudflare.com/ajax/libs/opal/0.3.43/opal.min.js')])
          .then(([CM, _, opal]) =>  {                
            console.log(opal);
            window.editor = new CM(document.querySelector("#code"), {
               mode: 'ruby',
               lineNumbers: true,
               theme: 'solarized light',
           }); 
          });
   });
   
   
</script>
